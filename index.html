<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Bestrafungs-Roulette â€“ Handy-optimiert (PWA)</title>
<!-- PWA-Manifest-Datei: Muss im selben Ordner liegen, damit der Browser die Installation anbieten kann -->
<link rel="manifest" href="manifest.json">

<style>
/* Alle Styles (CSS) hier integriert */
:root {
    --bg:#0f1720; 
    --card:#111827;
    --accent:#ef4444; /* Rot fÃ¼r Herzen */
    --install:#10b981; /* GrÃ¼n fÃ¼r Install-Button */
    --muted:#9ca3af;
    --heart-color: var(--accent);
}

* { box-sizing:border-box; -webkit-tap-highlight-color:transparent; }

body {
    margin:0; padding:0; 
    min-height:100vh;
    display:flex; align-items:center; justify-content:center;
    font-family:Inter,system-ui,Arial;
    background:linear-gradient(180deg,var(--bg),#071023 120%);
    color:#e6eef6;
    position: relative; 
    overflow: hidden;
}
 
/* --- HAUPTKARTE --- */
.card {
    padding:24px; 
    width:100%;
    max-width:780px;
    background:linear-gradient(180deg,var(--card),#0b1220);
    border-radius:14px;
    box-shadow:0 8px 30px rgba(2,6,23,0.6);
    display:flex; 
    flex-direction:column;
    align-items:center;
    gap:18px;
    position: relative; 
    z-index: 20;
}

.effect-wrap {
    display:flex;
    flex-direction:column;
    gap:20px;
    align-items:center;
    justify-content:center;
    height: 120px; 
    width: 100%;
}
 
#centerIndicator {
    height: 40px;
    line-height: 40px;
    color: var(--muted);
    font-size: 16px;
    opacity: 0.8;
}

/* --- HERZ-CONTAINER --- */
#heartsContainer {
    position: fixed; 
    top: 0;
    left: 0;
    width: 100vw;
    height: 100vh;
    pointer-events: none;
    z-index: 10; 
    opacity: 0; 
    transition: opacity 0.3s;
    overflow: hidden;
}

#heartsContainer.active {
    opacity: 1;
}

.heart {
    position: absolute;
    font-size: 30px; 
    transform: translateY(-20px); 
    animation: fall linear forwards;
    text-shadow: 0 0 5px rgba(239, 68, 68, 0.5); 
}

@keyframes fall {
    0% { transform: translateY(-20px); opacity: 1; }
    100% { transform: translateY(100vh); opacity: 0; } 
}

/* Buttons */
button {
    background:var(--accent);
    padding:12px 16px;
    border:none;
    border-radius:10px;
    font-weight:700;
    color:white;
    cursor:pointer;
    touch-action:manipulation;
    opacity:0.6; 
    transition:opacity 0.2s;
    white-space: nowrap; /* Wichtig fÃ¼r Install Button */
}

button.active {
    opacity:1; 
}

button.secondary {
    background:transparent;
    border:1px solid rgba(255,255,255,0.1);
    color:var(--muted);
    opacity:1; 
    padding:12px 16px;
}

/* NEUER INSTALL-BUTTON STYLING */
#installPwaBtn {
    background: var(--install); /* GrÃ¼ne Farbe fÃ¼r Installation */
    color: white;
    font-size: 14px;
    padding: 12px 16px;
    opacity: 1;
    transition: none;
    margin-left: 10px; /* Kleiner Abstand zu den anderen Buttons */
}

.result-box {
    margin-top:6px;
    width:100%;
    text-align:center;
    padding:14px;
    border-radius:8px;
    background:rgba(255,255,255,0.02);
    min-height:64px;
}
 
.selection-buttons button {
    background:#374151; 
    opacity:1;
    border:1px solid transparent;
}
.selection-buttons button.active {
    background:var(--accent);
}
</style>
</head>

<body>
Â  Â  <!-- HERZ-CONTAINER fÃ¼r den Fall-Effekt -->
Â  Â  <div id="heartsContainer"></div>
Â  Â Â 
<div class="card">
Â Â 
Â  <div class="effect-wrap">
Â  Â Â 
Â  Â  <div id="centerIndicator">
Â  Â  Â  Â  ğŸ’– Klicke auf Starten ğŸ’–
Â  Â  </div>

Â  Â  <!-- AUSWAHL-BUTTONS -->
Â  Â  <div class="selection-buttons" style="display:flex; gap:8px;">
Â  Â  Â  Â  <button id="selectHimBtn" class="active">ğŸ”¥ Nur fÃ¼r mich (Ihn)</button>
Â  Â  Â  Â  <button id="selectHerBtn">ğŸ’– Nur fÃ¼r Sie</button>
Â  Â  Â  Â  <button id="selectBothBtn">ğŸ”— FÃ¼r Beide</button>
Â  Â  </div>

Â  Â  <!-- AKTIONEN-REIHE MIT NEUEM INSTALL-BUTTON -->
Â  Â  <div id="actionRow" style="display:flex; gap:10px; align-items:center; flex-wrap: wrap; justify-content: center;">
Â  Â  Â  <button id="spinBtn" class="active">Starten</button>
Â  Â  Â  <button id="stopBtn" class="secondary" disabled>Stoppen</button>
Â  Â  Â  <!-- NEUER PWA INSTALLATIONS-BUTTON - StandardmÃ¤ÃŸig versteckt -->
Â  Â  Â  <button id="installPwaBtn" style="display:none;">
Â  Â  Â  Â  â¬‡ï¸ App installieren
Â  Â  Â  </button>
Â  Â  </div>

Â  Â  <div class="result-box" id="resultBox">WÃ¤hle eine Kategorie & klicke auf "Starten".</div>
Â  </div>
</div>

<script>
// JavaScript Code fÃ¼r Logik und PWA-Installation

/* --- AUFGABEN-DATEN --- */
const allTasks = [
Â  // 20 Aufgaben fÃ¼r IHN (DICH)
Â  { target: "DICH", task: "Lass dich von deiner Freundin fÃ¼nf Minuten lang mit einem GÃ¼rtel sanft auf den Hintern auspeitschen. WÃ¤hlt die IntensitÃ¤t vorher gemeinsam ab." },
Â  { target: "DICH", task: "Du musst ihr zehn Minuten lang die FÃ¼ÃŸe kÃ¼ssen und massieren, und zwar aufmerksam und leidenschaftlich." },
Â  { target: "DICH", task: "Nacktputz: Du musst ein von ihr bestimmtes Zimmer fÃ¼r zehn Minuten nackt aufrÃ¤umen oder putzen. Sie beaufsichtigt." },
Â  { target: "DICH", task: "Sie darf dir dreimal hintereinander einen festen Klaps auf den Po geben. Wie stark, bestimmt sie." },
Â  { target: "DICH", task: "Du musst ein von ihr gewÃ¤hltes KleidungsstÃ¼ck, zum Beispiel einen BH oder StrÃ¼mpfe, fÃ¼r dreiÃŸig Minuten tragen und dabei ihren Befehlen folgen." },
Â  { target: "DICH", task: "Sie darf dir einen Zungenkuss geben, so lange sie mÃ¶chte. Maximal fÃ¼nf Minuten. Du musst passiv bleiben." },
Â  { target: "DICH", task: "Du musst ihr einen Liebesbrief schreiben, in dem du ihr verrÃ¤tst, was dich am meisten an ihr anturnt." },
Â  { target: "DICH", task: "Laufe fÃ¼r fÃ¼nf Minuten nackt durch die Wohnung oder das Haus, wÃ¤hrend sie dich bewertet und kritisiert." },
Â  { target: "DICH", task: "Sie darf dich zehn Minuten lang an einer nicht erogenen Zone, zum Beispiel dem Arm oder dem Ohr, neckisch kneifen und fest drÃ¼cken." },
Â  { target: "DICH", task: "Du musst ihren Lieblingssong laut singen, wÃ¤hrend du ihr dabei in die Augen schaust." },
Â  { target: "DICH", task: "Du musst drei Dinge aus der Wohnung holen, die sie dir im Dunkeln zuruft. Augen verbinden." },
Â  { target: "DICH", task: "Sie darf dir zwanzig Sekunden lang einen festen Biss auf die Schulter geben. Du musst ein Stoppwort bereit haben." },
Â  { target: "DICH", task: "Du musst dich zehn Minuten lang in einem von ihr gewÃ¤hlten Outfit prÃ¤sentieren und ihr dienen." },
Â  { target: "DICH", task: "Schreibe fÃ¼nf Dinge auf, die du gerne in ihrem Bett tust und die sie dir bisher nicht erlaubt hat." },
Â  { target: "DICH", task: "Lass sie deine Haare oder deinen Bart stylen, wie sie mÃ¶chte. Du musst es fÃ¼r den Rest des Abends so lassen." },
Â  { target: "DICH", task: "Du musst ihr ein von ihr gewÃ¼nschtes GetrÃ¤nk zubereiten und es ihr auf Knien servieren." },
Â  { target: "DICH", task: "FÃ¼r die nÃ¤chsten dreiÃŸig Minuten darfst du nur mit einem LÃ¤cheln antworten, egal was sie fragt." },
Â  { target: "DICH", task: "Sie darf dich sanft fesseln und fÃ¼nfzehn Minuten lang bestimmen, was du tust. Maximal fÃ¼nfzehn Minuten." },
Â  { target: "DICH", task: "Du musst ihr fÃ¼nf Komplimente machen, die sich nur auf ihren Charakter, nicht ihr Aussehen, beziehen." },
Â  { target: "DICH", task: "Du musst ihr fÃ¼nf Minuten lang in die Augen schauen, ohne zu lachen oder wegzusehen." },


Â  // 20 Aufgaben fÃ¼r SIE (DEINE PARTNERIN)
Â  { target: "SIE", task: "Sie muss dir fÃ¼nfzehn Minuten lang eine erotische Massage geben, ohne dass du etwas anderes verlangst. Nur der EmpfÃ¤nger zÃ¤hlt." },
Â  { target: "SIE", task: "Sie muss dir einen Knutschfleck an einer von dir bestimmten Stelle, Hals oder Bauch, verpassen. Der Fleck muss mindestens eine Stunde sichtbar sein." },
Â  { target: "SIE", task: "Sie muss fÃ¼nf erotische Nachrichten (einvernehmliche) an dich senden, mit je einem Abstand von fÃ¼nfzehn Minuten." },
Â  { target: "SIE", task: "Sie darf fÃ¼nf Minuten lang deine Nacken- und Schulterpartie fest beiÃŸen und kneifen. Sie muss dabei auf dein Stoppwort achten." },
Â  { target: "SIE", task: "Sie muss ein von dir gewÃ¤hltes Gericht mit verbundenen Augen kochen oder zubereiten. Hilfe ist erlaubt." },
Â  { target: "SIE", task: "Sie muss sich komplett ausziehen und fÃ¼nf Minuten lang mit einem Gegenstand, zum Beispiel einem Besen oder der Fernbedienung, sinnlich tanzen." },
Â  { target: "SIE", task: "Sie muss dir erzÃ¤hlen, welche ihrer Grenzen sie fÃ¼r dich am ehesten Ã¼berschreiten wÃ¼rde, in einem sicheren Kontext." },
Â  { target: "SIE", task: "Sie muss dich fÃ¼nf Minuten lang an der Wange kneifen, wÃ¤hrend du versuchst, normal weiter zu reden." },
Â  { target: "SIE", task: "Sie muss einen Schnaps oder einen Shot trinken und dir danach ihre Handlungen fÃ¼r die nÃ¤chsten zehn Minuten Ã¼berlassen." },
Â  { target: "SIE", task: "Sie muss dir fÃ¼r fÃ¼nfzehn Minuten auf dem SchoÃŸ sitzen und dich ohne HÃ¤nde fÃ¼ttern." },
Â  { target: "SIE", task: "Sie muss dir blind vertrauen. Sie lÃ¤sst sich von dir an einen geheimen Ort fÃ¼hren, zum Beispiel die Badewanne, ohne Fragen zu stellen." },
Â  { target: "SIE", task: "Sie muss fÃ¼nf erogene Zonen an deinem KÃ¶rper benennen, die sie bisher vernachlÃ¤ssigt hat." },
Â  { target: "SIE", task: "Sie muss ein Outfit aus ihrer Jugend anziehen und dir dazu eine peinliche Geschichte erzÃ¤hlen." },
Â  { target: "SIE", task: "Sie darf dir zweimal fest in den Arm beiÃŸen. Sie muss dich vorher fragen, wo." },
Â  { target: "SIE", task: "Sie muss zehn Minuten lang ihre HÃ¤nde hinter dem RÃ¼cken halten und dich nur mit dem Mund oder den FÃ¼ÃŸen verwÃ¶hnen." },
Â  { target: "SIE", task: "Sie muss dir ein GestÃ¤ndnis Ã¼ber eine heimliche Eifersucht oder einen heimlichen Wunsch machen." },
Â  { target: "SIE", task: "Sie muss drei Minuten lang den Wandsitz, die Hocke an der Wand, halten, wÃ¤hrend du sie neckst." },
Â  { target: "SIE", task: "Sie muss dir einen EiswÃ¼rfel-Blowjob geben, mit einem EiswÃ¼rfel im Mund." },
Â  { target: "SIE", task: "Sie muss dich fÃ¼nf Minuten lang mit einem nassen Handtuch leicht schlagen. Immer nur ein Schlag pro Minute." },
Â  { target: "SIE", task: "Sie muss dich auf Befehl Herr nennen, wenn du danach fragst, fÃ¼r dreiÃŸig Minuten." },


Â  // 20 Aufgaben fÃ¼r BEIDE (EUCH)
Â  { target: "BEIDE", task: "Ihr spielt fÃ¼nf Minuten lang Herr und Sklavin. Sie ist die Herrin und du musst alle ihre, einvernehmlichen, Befehle ausfÃ¼hren." },
Â  { target: "BEIDE", task: "ErzÃ¤hlt euch gegenseitig, was eure grÃ¶ÃŸte Sexphantasie mit dem anderen ist. Ihr wÃ¤hlt gemeinsam die spannendste aus." },
Â  { target: "BEIDE", task: "Kneifen/BeiÃŸen/Schlagen-Roulette: Sie darf dich dreimal fest kneifen. Du darfst danach einmal sie an einer Stelle beiÃŸen, die sie wÃ¤hlt, aber nur leicht! Die IntensitÃ¤t mÃ¼sst ihr vorher abstimmen." },
Â  { target: "BEIDE", task: "Ihr mÃ¼sst zwanzig Minuten lang komplett nackt sein, egal was ihr tut, wie Fernsehen oder Haushalt." },
Â  { target: "BEIDE", task: "Nimm einen EiswÃ¼rfel in den Mund und gib ihn ihr in den Mund â€“ ohne die HÃ¤nde zu benutzen." },
Â  { target: "BEIDE", task: "Ihr mÃ¼sst euch gegenseitig die Kleidung vom Leib reiÃŸen, ohne Verletzung, und danach sofort zehn Minuten lang mit KÃ¼ssen verbringen." },
Â  { target: "BEIDE", task: "Fesselt euch gegenseitig an den Handgelenken und versucht, euch so gegenseitig ein GetrÃ¤nk einzuschenken und zu trinken." },
Â  { target: "BEIDE", task: "Einer wÃ¤hlt drei Stellen am KÃ¶rper des anderen, die er kÃ¼ssen muss. Der GekÃ¼sste muss dabei still bleiben." },
Â  { target: "BEIDE", task: "Ihr mÃ¼sst fÃ¼nfzehn Minuten lang in kompletter Dunkelheit miteinander reden, ohne euch dabei zu berÃ¼hren." },
Â  { target: "BEIDE", task: "Beide mÃ¼ssen fÃ¼nf Minuten lang in der KÃ¼che knien und der andere darf sie mit Essbarem, zum Beispiel Schlagsahne, fÃ¼ttern." },
Â  { target: "BEIDE", task: "Ihr mÃ¼sst beide ein T-Shirt des anderen anziehen, aber falsch herum, mit dem Halsausschnitt am Po." },
Â  { target: "BEIDE", task: "Ihr mÃ¼sst einen Tanz erfinden, der nur aus fÃ¼nf Schritten besteht, und diesen dreimal auffÃ¼hren." },
Â  { target: "BEIDE", task: "Schlagt abwechselnd mit einem Kissen auf den Hintern des anderen. Insgesamt zehn SchlÃ¤ge pro Person." },
Â  { target: "BEIDE", task: "Ihr mÃ¼sst zehn Minuten lang mit verbundenen Augen die Handlungen des anderen erraten." },
Â  { target: "BEIDE", task: "Der eine kniet, der andere sitzt auf seinem RÃ¼cken. So mÃ¼ssen sie gemeinsam fÃ¼nf Minuten lang Fernsehen schauen." },
Â  { target: "BEIDE", task: "Ihr mÃ¼sst fÃ¼nf Minuten lang in der Ã–ffentlichkeit, zum Beispiel auf dem Balkon oder am Fenster, in UnterwÃ¤sche stehen und euch kÃ¼ssen." },
Â  { target: "BEIDE", task: "Jeder schreibt drei Verbote auf einen Zettel. Der andere muss diese Verbote fÃ¼r die nÃ¤chsten zwei Stunden befolgen." },
Â  { target: "BEIDE", task: "Ihr mÃ¼sst euch gegenseitig mit einer Feder kitzeln, bis einer von euch lacht oder kapituliert." },
Â  { target: "BEIDE", task: "Beide mÃ¼ssen einen Shot trinken. Danach muss jeder dem anderen fÃ¼nf Minuten lang die Kleidung anziehen." },
Â  { target: "BEIDE", task: "Ihr mÃ¼sst euch gegenseitig Haustiere sein. FÃ¼nfzehn Minuten lang muss einer Futter geben und der andere Miau oder Wuff machen." }
];

const heartsContainer = document.getElementById("heartsContainer");
const resultBox = document.getElementById("resultBox");
const spinBtn = document.getElementById("spinBtn");
const stopBtn = document.getElementById("stopBtn");
const centerIndicator = document.getElementById("centerIndicator");

const selectHimBtn = document.getElementById("selectHimBtn");
const selectHerBtn = document.getElementById("selectHerBtn");
const selectBothBtn = document.getElementById("selectBothBtn");

// Neuer PWA Installations-Button
const installPwaBtn = document.getElementById('installPwaBtn');

// Variablen fÃ¼r den Installations-Prompt (PWA)
let deferredPrompt = null;


let selectedTarget = "DICH";
let starting = false;
let timeoutHandle = null;
let heartInterval = null;


function updateSelection(target) {
    selectHimBtn.classList.remove("active");
    selectHerBtn.classList.remove("active");
    selectBothBtn.classList.remove("active");

    if (target === "DICH") {
        selectHimBtn.classList.add("active");
        resultBox.innerHTML = 'Kategorie **FÃ¼r mich (Ihn)** ausgewÃ¤hlt. Klicke auf "Starten".';
    } else if (target === "SIE") {
        selectHerBtn.classList.add("active");
        resultBox.innerHTML = 'Kategorie **FÃ¼r Sie** ausgewÃ¤hlt. Klicke auf "Starten".';
    } else if (target === "BEIDE") {
        selectBothBtn.classList.add("active");
        resultBox.innerHTML = 'Kategorie **FÃ¼r Beide** ausgewÃ¤hlt. Klicke auf "Starten".';
    }

    selectedTarget = target;
}

// --- HERZ FUNKTIONEN (Visueller Effekt) ---

function createHeart() {
    const heart = document.createElement('div');
    heart.classList.add('heart');
    
    heart.innerHTML = 'ğŸ’–';
    
    heart.style.left = Math.random() * 100 + 'vw';
    
    const fontSize = 20 + Math.random() * 15; 
    heart.style.fontSize = fontSize + 'px';
    
    const duration = 2 + Math.random() * 2; 
    const delay = Math.random() * 0.5;
    
    heart.style.animationDuration = duration + 's';
    heart.style.animationDelay = delay + 's';
    
    heartsContainer.appendChild(heart);
    
    heart.addEventListener('animationend', () => {
        heart.remove();
    });
}

function startHeartFall() {
    heartsContainer.classList.add('active'); 
    centerIndicator.innerHTML = '...ğŸ’–...';
    heartInterval = setInterval(createHeart, 80); 
}

function stopHeartFall() {
    if (heartInterval) clearInterval(heartInterval);
    heartsContainer.classList.remove('active'); 
    centerIndicator.innerHTML = 'âœ… Aufgabe gefunden! âœ…';
    
    setTimeout(() => {
        Array.from(heartsContainer.children).forEach(heart => heart.remove());
        if (!starting) { 
            centerIndicator.innerHTML = 'ğŸ’– Klicke auf Starten ğŸ’–';
        }
    }, 500); 
}

// --- SPRACHSYNTHESE FUNKTION ---
function readTaskAloud(text) {
    window.speechSynthesis.cancel(); 
    
    if ('speechSynthesis' in window) {
        const utterance = new SpeechSynthesisUtterance(text);
        utterance.lang = 'de-DE'; 
        
        utterance.rate = 0.8; 
        utterance.pitch = 0.8;
        
        const voices = window.speechSynthesis.getVoices();
        const germanVoice = voices.find(voice => voice.lang === 'de-DE') || voices.find(voice => voice.lang.startsWith('de'));
        if (germanVoice) {
            utterance.voice = germanVoice;
        }

        window.speechSynthesis.speak(utterance);
    } else {
        console.warn('Speech Synthesis API wird von diesem Browser nicht unterstÃ¼tzt.');
    }
}


// --- STEUERUNGS FUNKTIONEN ---

function startEffect() {
    if (starting) return;
    window.speechSynthesis.cancel(); 

    starting = true;
    spinBtn.disabled = true;
    stopBtn.disabled = false;
    
    selectHimBtn.disabled = true;
    selectHerBtn.disabled = true;
    selectBothBtn.disabled = true;
    // PWA Button muss auch deaktiviert werden, falls sichtbar
    installPwaBtn.disabled = true;

    resultBox.innerHTML = 'Die Herzen fallen... Eine Aufgabe wird ermittelt...';
    
    startHeartFall();

    const duration = 3000; 
    
    timeoutHandle = setTimeout(() => {
        stopHeartFall();
        
        starting = false;
        spinBtn.disabled = false;
        stopBtn.disabled = true;
        
        selectHimBtn.disabled = false;
        selectHerBtn.disabled = false;
        selectBothBtn.disabled = false;
        // PWA Button wieder aktivieren
        installPwaBtn.disabled = false;
        
        displayResult(selectedTarget);
    }, duration); 
}

function stopNow() {
    if (!starting) return;
    
    clearTimeout(timeoutHandle);
    stopHeartFall();
    
    starting = false;
    spinBtn.disabled = false;
    stopBtn.disabled = true;
    
    selectHimBtn.disabled = false;
    selectHerBtn.disabled = false;
    selectBothBtn.disabled = false;
    installPwaBtn.disabled = false; // PWA Button wieder aktivieren
    
    displayResult(selectedTarget);
}

function displayResult(target) {
    const filteredTasks = allTasks.filter(task => task.target === target);
    
    if (filteredTasks.length === 0) {
        resultBox.innerHTML = 'FEHLER: Keine Aufgaben in dieser Kategorie gefunden.';
        return;
    }
    
    const randomIndex = Math.floor(Math.random() * filteredTasks.length);
    const result = filteredTasks[randomIndex];
    
    let header = '';
    let targetPhrase = ''; 
    
    switch(result.target) {
        case "DICH":
            header = 'ğŸ”¥ AUFGABE FÃœR DICH (IHN) ğŸ”¥';
            targetPhrase = 'Aufgabe fÃ¼r den Mann.';
            break;
        case "SIE":
            header = 'ğŸ’– AUFGABE FÃœR SIE ğŸ’–';
            targetPhrase = 'Aufgabe fÃ¼r die Frau.';
            break;
        case "BEIDE":
            header = 'ğŸ”— AUFGABE FÃœR EUCH BEIDE ğŸ”—';
            targetPhrase = 'Aufgabe fÃ¼r euch beide.';
            break;
    }

    resultBox.innerHTML = `**${header}**<br>${result.task}`;

    const fullTaskText = `${targetPhrase} ${result.task}`; 
    readTaskAloud(fullTaskText);
}

/* --- PWA INSTALLATIONS-LOGIK (Verwendet den diskreten Button) --- */

window.addEventListener('beforeinstallprompt', (e) => {
    // Wenn die App bereits installiert ist, brauchen wir keinen Button
    if (window.matchMedia('(display-mode: standalone)').matches || window.navigator.standalone) {
        return; 
    }
    
    // Verhindere, dass der Browser den Standard-Prompt sofort anzeigt
    e.preventDefault();
    deferredPrompt = e;
    
    // Zeige den diskreten Installations-Button an, wenn das Event feuert
    if (installPwaBtn) {
        installPwaBtn.style.display = 'block'; 
    }
});

// Klick auf den Installations-Button
if (installPwaBtn) {
    installPwaBtn.addEventListener('click', () => {
        if (deferredPrompt) {
            // 1. Verstecke den Installations-Button sofort, da der native Prompt kommt
            installPwaBtn.style.display = 'none';
            
            // 2. Zeige die native Installations-Eingabeaufforderung des Browsers an
            deferredPrompt.prompt();
            
            // 3. Ãœberwache die Benutzerentscheidung
            deferredPrompt.userChoice.then((choiceResult) => {
                // Setze deferredPrompt zurÃ¼ck, nachdem es einmal verwendet wurde
                deferredPrompt = null;
                // Wenn der Benutzer es ablehnt (dismissed), zeige den Button wieder an
                if (choiceResult.outcome === 'dismissed') {
                    installPwaBtn.style.display = 'block';
                }
            });
        }
    });
}

// Wenn die App erfolgreich installiert wird, Button ausblenden
window.addEventListener('appinstalled', () => {
    if (installPwaBtn) {
        installPwaBtn.style.display = 'none';
    }
});


// EVENT LISTENER
selectHimBtn.addEventListener("click", () => updateSelection("DICH"));
selectHerBtn.addEventListener("click", () => updateSelection("SIE"));
selectBothBtn.addEventListener("click", () => updateSelection("BEIDE"));

spinBtn.addEventListener("click", startEffect);
stopBtn.addEventListener("click", stopNow);

// Startet die Auswahl beim Laden der Seite
window.onload = () => {
    updateSelection("DICH");
    // Initialisiere die Sprachausgabe
    if ('speechSynthesis' in window && window.speechSynthesis.getVoices().length === 0) {
        window.speechSynthesis.onvoiceschanged = () => {
            console.log("Sprachstimmen geladen.");
        };
    }
}
</script>

</body>
</html>

